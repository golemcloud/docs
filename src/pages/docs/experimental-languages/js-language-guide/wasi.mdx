import { Callout, FileTree, Tabs } from "nextra/components"
import { AllWitDeps } from "@/components/all-wit-deps"
import { PackageManagerCommand } from "@/components/package-manager-command"

# Using WASI interfaces from JavaScript

Golem implements and exports a subset of the [WASI](https://wasi.dev) interfaces, as well as its own **runtime interfaces**.

The [Golem JavaScript SDK](/docs/experimental-languages/js-language-guide/golem-js-sdk) provides idiomatic wrappers on a subset of these interfaces, but it is also possible to use the generated bindings directly.

## WIT specifications

The full set of WIT specifications Golem implements is available in the following public repository:

https://github.com/golemcloud/golem-wit/tree/main/wit/deps

The following table lists all packages provided by Golem:

| Package           | Description                                                                                 |
| ----------------- | ------------------------------------------------------------------------------------------- |
| `golem:api`       | Golem's Runtime API                                                                         |
| `golem:rpc`       | Provides support for Worker to Worker communication                                         |
| `wasi:blobstore`  | Interface for storing and retrieving large binary data                                      |
| `wasi:cli`        | Interface for environment variables and standard I/O                                        |
| `wasi:clocks`     | Interface for querying the system time                                                      |
| `wasi:filesystem` | Interface for working with files and directories                                            |
| `wasi:http`       | Interface for making HTTP requests                                                          |
| `wasi:io`         | Interface for working with futures and streams                                              |
| `wasi:keyvalue`   | Interface for storing and retrieving key-value pairs - only partially implemented           |
| `wasi:logging`    | Interface for logging messages                                                              |
| `wasi:random`     | Interface for generating random numbers                                                     |
| `wasi:sockets`    | Interface for working with TCP and UDP sockets (currently not supporting durable execution) |

## WIT to JavaScript Type Mapping

The following table shows how WIT types are mapped to JavaScript types:

| WIT Type                             | JS Type    | Notes                                                       |
| ------------------------------------ | ---------- | ----------------------------------------------------------- |
| bool                                 | boolean    |                                                             |
| u8, s8, u16, s16, u32, s32, f32, f64 | number     |                                                             |
| u64, s64                             | bigint     |                                                             |
| char                                 | string     | Represents a single Unicode character                       |
| string                               | string     |                                                             |
| list\<T>                             | Array      | For most types                                              |
| list\<u8>                            | Uint8Array | Special case for byte arrays                                |
| tuple\<T1, T2, ...>                  | Array      |                                                             |
| record                               | Object     | Fields become properties                                    |
| variant                              | Object     | Each case becomes an object with a `tag` and optional `val` |
| enum                                 | string     |                                                             |
| option\<T>                           | T \| null  | If T can be represented as null                             |
| option\<T>                           | Object     | If T cannot be represented as null                          |
| result\<T, E>                        | Object     |                                                             |
| flags                                | Object     | Each flag becomes an optional boolean property              |
| resource                             | class      | Methods become class methods                                |

Note: The `Option` and `Result` types are represented as objects in JavaScript if they cannot be represented as null or a simple value.

They are structured as follows:

```javascript
// Option
{ tag: "none" } | { tag: "some", val: T }

// Result
{ tag: "ok", val: T } | { tag: "err", val: E }
```

#### Variant Type Example

```javascript
// UserRole can be one of these objects:
{ tag: "guest" }
{ tag: "regular-user" }
{ tag: "admin" }
{ tag: "super-moderator", val: string }
```

#### Flags Type Example

```javascript
// OpenFlags
{
  create: boolean,
  directory: boolean,
  exclusive: boolean,
  truncate: boolean,
  readWrite: boolean
}
```

## Generate JavaScript Bindings for WASI

Run the `stub` command with the package manager of your choice

This script should have been setup during the [installation of the Golem JavaScript SDK](/docs/experimental-languages/js-language-guide/golem-js-sdk#scripts).

<PackageManagerCommand
  command={[
    { label: "npm", command: "npm run stub" },
    { label: "pnpm", command: "pnpm run stub" },
    { label: "yarn", command: "yarn run stub" },
    { label: "bun", command: "bun run stub" },
  ]}
/>
